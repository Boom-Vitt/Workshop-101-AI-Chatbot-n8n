# BOOM BIG NOSE Chat

แอปพลิเคชันแชทอย่างง่าย พร้อมระบบล็อกอิน/สมัครสมาชิก และการเชื่อมต่อกับ Webhook

## สิ่งที่ต้องมี (โปรแกรมพื้นฐานที่ต้องติดตั้งก่อน)

*   **Node.js:** โปรแกรมสำหรับรันโค้ด JavaScript ฝั่งเซิร์ฟเวอร์
    *   **ดาวน์โหลดได้ที่นี่:** [https://nodejs.org/](https://nodejs.org/)
    *   (แนะนำให้เลือกเวอร์ชัน **LTS** ซึ่งเป็นเวอร์ชันที่เสถียรและแนะนำสำหรับผู้ใช้ส่วนใหญ่) คลิกดาวน์โหลดไฟล์ติดตั้งสำหรับระบบปฏิบัติการของคุณ (Windows หรือ macOS) แล้วเปิดไฟล์เพื่อติดตั้งตามขั้นตอน
*   **npm (Node Package Manager):** เครื่องมือสำหรับจัดการส่วนเสริมต่างๆ ของ Node.js **โดยปกติจะถูกติดตั้งมาพร้อมกับ Node.js โดยอัตโนมัติ** ไม่จำเป็นต้องติดตั้งแยกต่างหาก
*   **Terminal หรือ Command Prompt:** โปรแกรมสำหรับพิมพ์คำสั่งต่างๆ ในคอมพิวเตอร์
    *   **Windows:** ค้นหา "Command Prompt" หรือ "PowerShell"
    *   **macOS:** ค้นหา "Terminal" ใน Applications > Utilities

## การติดตั้ง (ขั้นตอนการเตรียมโค้ดให้พร้อมใช้งาน)

1.  **ดาวน์โหลดโค้ด (Clone Repository):**
    เปิด Terminal หรือ Command Prompt แล้วรันคำสั่ง:
    ```bash
    git clone <ลิงก์-repository-ของคุณ>
    ```
    (แทนที่ `<ลิงก์-repository-ของคุณ>` ด้วย URL ของ GitHub repository ของคุณ)

2.  **เข้าไปยังโฟลเดอร์โปรเจกต์:**
    ```bash
    cd <ชื่อ-directory-ของโปรเจกต์>
    ```
    (แทนที่ `<ชื่อ-directory-ของโปรเจกต์>` ด้วยชื่อโฟลเดอร์ที่ถูกสร้างขึ้นหลังจากการ clone)

3.  **ติดตั้ง Dependencies (ส่วนเสริมที่จำเป็น):**
    รันคำสั่ง:
    ```bash
    npm install
    ```
    คำสั่งนี้จะดาวน์โหลดและติดตั้ง `express` และ `node-fetch` ที่โปรเจกต์ต้องการใช้งาน

## การรันแอปพลิเคชัน

1.  **เริ่มการทำงานของเซิร์ฟเวอร์:**
    ใน Terminal หรือ Command Prompt ที่อยู่ในโฟลเดอร์โปรเจกต์ ให้รันคำสั่ง:
    ```bash
    node server.js
    ```
    คุณควรจะเห็นข้อความ `เซิร์ฟเวอร์กำลังทำงานบนพอร์ต 3000` (หรือพอร์ตอื่นหากมีการตั้งค่าไว้)

2.  **เปิดใช้งาน:**
    เปิดเว็บเบราว์เซอร์ของคุณ (เช่น Chrome, Firefox) แล้วไปที่ URL:
    ```
    http://localhost:3000
    ```

## การตั้งค่าเพิ่มเติม (ถ้าต้องการ)

*   **Webhook URL:** URL ของ n8n webhook ถูกกำหนดค่าไว้โดยตรงในไฟล์ `server.js` (บรรทัด ~123) และ `script.js` (บรรทัด ~7) หากคุณใช้ webhook URL อื่น ต้องแก้ไขค่าเหล่านี้ในโค้ด
*   **Port:** เซิร์ฟเวอร์จะทำงานบนพอร์ต 3000 โดยค่าเริ่มต้น หากต้องการเปลี่ยน สามารถตั้งค่าผ่าน Environment Variable ชื่อ `PORT` ก่อนรันเซิร์ฟเวอร์ได้ (วิธีการตั้งค่าขึ้นอยู่กับระบบปฏิบัติการของคุณ)

## การทดสอบ Webhook ด้วย Ngrok (สำหรับนักพัฒนา)

หากคุณต้องการทดสอบการทำงานของ Webhook callback จาก n8n (หรือบริการภายนอกอื่นๆ) ไปยังเซิร์ฟเวอร์ที่รันอยู่บนเครื่องของคุณ (localhost) คุณจำเป็นต้องทำให้เซิร์ฟเวอร์ของคุณเข้าถึงได้จากอินเทอร์เน็ต เครื่องมือที่นิยมใช้คือ `ngrok`

**Ngrok คืออะไร?**
Ngrok สร้างอุโมงค์ (tunnel) ที่ปลอดภัยจากอินเทอร์เน็ตสาธารณะมายังแอปพลิเคชันที่รันอยู่บน `localhost` ของคุณ ทำให้บริการภายนอกสามารถส่ง request กลับมายังเครื่องของคุณได้

**ขั้นตอน:**

1.  **ติดตั้ง Ngrok:**
    *   ดาวน์โหลด Ngrok จากเว็บไซต์อย่างเป็นทางการ: [https://ngrok.com/download](https://ngrok.com/download)
    *   ทำตามคำแนะนำในการติดตั้งสำหรับระบบปฏิบัติการของคุณ (โดยทั่วไปคือการ unzip ไฟล์และอาจจะต้องเพิ่มลงใน PATH ของระบบ)
    *   (แนะนำ) สมัครสมาชิกฟรีที่ ngrok.com และเพิ่ม authtoken ของคุณตามคำแนะนำ เพื่อให้ใช้งานได้นานขึ้นและมีฟีเจอร์เพิ่มเติม:
        ```bash
        ngrok config add-authtoken <YOUR_AUTHTOKEN>
        ```

2.  **รันแอปพลิเคชันของคุณ:**
    ตรวจสอบให้แน่ใจว่าเซิร์ฟเวอร์ Node.js ของคุณกำลังทำงานอยู่ (ใช้ `node server.js`)

3.  **เริ่ม Ngrok:**
    เปิด Terminal หรือ Command Prompt อันใหม่ (แยกต่างหากจากที่รันเซิร์ฟเวอร์) แล้วรันคำสั่ง:
    ```bash
    ngrok http 3000
    ```
    (หากเซิร์ฟเวอร์ของคุณรันบนพอร์ตอื่นที่ไม่ใช่ 3000 ให้เปลี่ยนเลข 3000 เป็นพอร์ตนั้น)

4.  **ดูผลลัพธ์:**
    Ngrok จะแสดงผลลัพธ์ใน Terminal ซึ่งจะมี URL สาธารณะขึ้นต้นด้วย `https://` ในส่วน `Forwarding` เช่น:
    ```
    Forwarding                    https://xxxxxxxxxxxx.ngrok-free.app -> http://localhost:3000
    ```
    ให้คัดลอก URL ที่ขึ้นต้นด้วย `https://` นี้

5.  **อัปเดต Webhook:**
    *   ไปที่ n8n workflow ของคุณ หรือที่ใดก็ตามที่คุณกำหนดค่าให้ส่ง Webhook callback กลับมา
    *   แก้ไข URL ที่ใช้สำหรับ callback (ซึ่งเดิมอาจจะเป็น `https://workshop101.boombignose.site/api/webhook-response`) ให้เป็น URL ที่ได้จาก Ngrok ตามด้วย path เดิม:
        `https://xxxxxxxxxxxx.ngrok-free.app/api/webhook-response`
    *   **สำคัญ:** ต้องแน่ใจว่าคุณใช้ URL ที่เป็น **HTTPS** จาก Ngrok

ตอนนี้ เมื่อ n8n พยายามส่ง response กลับมา มันจะถูกส่งผ่าน Ngrok ไปยังเซิร์ฟเวอร์ที่รันอยู่บน `localhost:3000` ของคุณ ทำให้คุณสามารถทดสอบและดีบั๊กการทำงานของ `/api/webhook-response` ได้

**หมายเหตุ:**
*   URL จาก Ngrok (โดยเฉพาะเวอร์ชันฟรี) จะเปลี่ยนไปทุกครั้งที่คุณหยุดและเริ่ม `ngrok` ใหม่ คุณต้องอัปเดต URL ใน n8n ทุกครั้งที่รัน ngrok ใหม่
*   ต้องเปิด `ngrok` ทิ้งไว้ตลอดเวลาที่ต้องการทดสอบ

## การอนุญาตใช้งาน (License)

โค้ดนี้เปิดให้ใช้งานเพื่อการศึกษาและทดลองส่วนตัว หากต้องการนำโค้ดนี้ไปใช้ในเชิงพาณิชย์ กรุณาติดต่อเพื่อขออนุญาตก่อนที่: [vittawat.soo@gmail.com](mailto:vittawat.soo@gmail.com)
